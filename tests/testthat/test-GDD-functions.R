
test_that("simple GDD is calculated correctly for positive results", {
  expect_equal(calc_GDD(T_max = 24.12, T_min = 15.94, T_base = 10), 10.03)
  expect_equal(calc_GDD(T_max = 14.6, T_min = 6.8, T_base = 7.1), 3.6)
})


test_that("simple GDD is zero when T_base > T_avg", {
  expect_equal(calc_GDD(11.7, 4.6, 10), 0)  # -1.85
})


test_that("when T_max is greater than T_base, calc_GDD returns zero", {
  expect_equal(calc_GDD(T_max = 51, T_min = 14, T_base = 10, T_upper = 50), 0)
})


test_that("default T_upper is 1000", {
  expect_equal(calc_GDD(T_max = 16, T_min = 14, T_base = 10), 5)
})



test_that("weighted GDD is calculated correctly", {

  # Data --------------------------------------------------------------------

  # parameters
  params <- c(base_budb = 3.5,
              base_leaf = 7.1,
              bracket_budb_leaf = 350,
              bracket_leaf_pick = 1000,
              DMT_threshold_pctile = 0.95)

  # constants
  base_budb <- params[["base_budb"]]
  base_leaf <- params[["base_leaf"]]
  bracket_budb_leaf <- params[["bracket_budb_leaf"]]
  bracket_leaf_pick <- params[["bracket_leaf_pick"]]
  DMT_threshold_pctile <- params[["DMT_threshold_pctile"]]

  # sample temperature data
  x <- c(8.49, 9.95, 9.45, 11.58, 8.41, 8.76, 7.00, 8.33, 8.14, 8.88, 7.68, 7.48, 7.96, 8.86, 7.99, 7.09, 7.17, 7.00, 5.95, 5.54,
         4.65, 4.27, 7.96, 9.40, 8.92, 7.77, 8.72, 6.60, 9.57, 9.26, 9.04, 8.36, 8.77, 6.05, 6.45, 5.44, 7.37, 7.16, 11.00, 8.03,
         9.34, 7.95, 9.33, 10.69, 11.96, 9.63, 8.95, 9.32, 7.99, 8.81, 7.67, 8.91, 8.83, 6.69, 8.09, 7.39, 7.51, 9.78, 9.12, 8.49,
         7.11, 11.32, 10.84, 10.62, 9.87, 12.19, 9.41, 10.47, 11.81, 13.05, 13.69, 12.76, 13.77, 14.80, 12.91, 8.62, 9.46, 9.61, 9.29, 9.31,
         11.93, 11.40, 9.39, 11.21, 12.75, 17.66, 12.78, 10.36, 11.65, 16.29, 21.66, 21.83, 11.82, 10.09, 11.66, 12.84, 13.58, 16.78, 18.48,
         17.79, 20.92, 12.99, 12.48, 15.08, 16.72, 12.71, 8.46, 10.04, 15.25, 22.03, 20.71, 14.65, 10.01, 9.93, 13.20, 13.48, 11.92, 12.67, 12.80,
         16.07, 19.26, 22.61, 14.16, 11.17, 14.51, 17.79, 22.75, 27.78, 16.88, 12.58, 11.95, 11.44, 12.23, 12.00, 17.41, 20.32, 17.19, 12.96, 11.50,
         12.47, 15.46, 17.77, 19.10, 22.88, 16.46, 12.57, 13.02, 11.29, 13.41, 15.68, 19.78, 18.30, 15.88, 16.21, 20.67, 23.49, 18.60, 14.91, 12.80,
         11.92, 13.64, 14.96, 15.83, 16.29, 17.55, 18.08, 17.35, 20.28, 22.38, 16.31, 12.89, 11.82, 14.63, 18.37, 21.22, 22.94, 25.24, 23.52, 24.55,
         27.19, 21.57, 16.19, 15.41, 16.69, 17.35, 17.99, 19.02, 16.75, 16.39, 18.61, 19.73, 21.12, 20.94, 19.90, 18.50, 17.95, 19.67, 23.37, 27.95,
         28.02, 21.50, 18.39, 14.00, 15.29, 15.73, 15.65, 20.35, 24.44, 24.71, 20.47, 23.28, 23.85, 25.48, 20.93, 16.42, 15.06, 16.41, 16.29, 20.23,
         24.25, 26.22, 27.96, 19.79, 17.49, 14.66, 14.76, 20.65, 23.32, 15.80, 17.32, 19.12, 21.18, 24.91, 17.90, 16.66, 15.81, 15.69, 15.26, 17.00,
         16.93, 16.62, 20.05, 24.18, 14.42, 13.21, 15.34, 15.04, 15.60, 17.22, 19.24, 21.55, 20.09, 19.71, 19.53, 18.48, 18.91, 21.06, 23.05, 24.11,
         20.76, 16.88, 16.03, 17.23, 20.05, 15.87, 16.25, 17.27, 19.52, 21.88, 16.50, 15.27, 13.24, 14.56, 16.86, 19.72, 19.62, 16.48, 12.89, 11.43,
         13.44, 15.59, 16.56, 13.73, 13.43, 12.63, 12.72, 13.39, 11.50, 10.53, 11.84, 12.39, 12.41, 14.07, 15.20, 18.64, 20.57, 14.50, 14.31, 17.04,
         23.08, 22.80, 14.43, 9.39, 11.16, 8.92, 9.32, 10.04, 10.94, 11.45, 12.19, 8.80, 10.92, 9.87, 9.35, 8.80, 9.04, 10.04, 11.20, 15.02,
         10.08, 11.00, 11.70, 9.97, 10.38, 10.46, 9.28, 7.67, 9.36, 8.81, 8.90, 8.13, 9.16, 8.09, 11.08, 12.43, 15.15, 12.30, 11.50, 10.33,
         11.25, 12.33, 12.05, 12.65, 11.10, 10.23, 11.01, 11.26, 11.83, 8.39, 10.64, 11.81, 11.77, 14.43, 13.75, 12.07, 10.94, 7.45, 8.08, 11.28,
         9.36, 6.61, 7.40, 10.27, 9.29, 7.22)

  # Test --------------------------------------------------------------------

  # manually pre calculated answer from spreadsheet
  pre_calc_GDD_weighted <- 2251.370

  # for simplicity, T_max = T_min, and thus = T_avg
  GDD_base_budb <- calc_GDD(x, x, base_budb)
  GDD_base_leaf <- calc_GDD(x, x, base_leaf)
  GDD_base_10 <- calc_GDD(x, x, 10)


  GDD_weighted <- calc_GDD_weighted(T_max = x, T_min = x,
                                    T_budb = params[["base_budb"]], T_leaf = params[["base_leaf"]], T_vera = 10,
                                    GDD_budb_threshold = 350, GDD_leaf_threshold = 1000, GDD_harvest_threshold = 1300)

  GDD_weighted_last_val <- GDD_weighted[length(GDD_weighted)]
  expect_equal(GDD_weighted_last_val, pre_calc_GDD_weighted)
})



test_that("weighted GDD is calculated correctly when data stays in first stage", {

  # sample temperature data
  x <- c(10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
         10, 10, 10, 10, 10, 10, 10, 10, 10, 10)

  GDD_weighted <- calc_GDD_weighted(T_max = x, T_min = x,
                                    T_budb = 5, T_leaf = 7.5, T_vera = 10,
                                    GDD_budb_threshold = 999, GDD_leaf_threshold = 1000, GDD_harvest_threshold = 1300)

  GDD_weighted_last_val <- GDD_weighted[length(GDD_weighted)]

  # manually pre calculated answer from spreadsheet
  # calc_GDD(x, x, T_base = 3.5) %>% cumsum
  pre_calc_GDD_weighted <- 100

  expect_equal(GDD_weighted_last_val, pre_calc_GDD_weighted)
})


test_that("weighted GDD is calculated correctly when data stays in first two stages", {

  # sample temperature data
  x <- c(10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
         10, 10, 10, 10, 10, 10, 10, 10, 10, 10)

  GDD_weighted <- calc_GDD_weighted(T_max = x, T_min = x,
                                    T_budb = 5, T_leaf = 7.5, T_vera = 10,
                                    GDD_budb_threshold = 75, GDD_leaf_threshold = 100, GDD_harvest_threshold = 1300)

  GDD_weighted_last_val <- GDD_weighted[length(GDD_weighted)]

  # manually pre calculated answer from spreadsheet
  pre_calc_GDD_weighted <- 90

  expect_equal(GDD_weighted_last_val, pre_calc_GDD_weighted)
})


{
  # Data --------------------------------------------------------------------

  # expected values also calculated in spreadsheet

  dates <- seq(as.Date("2018-07-01"), as.Date("2019-06-30"), "days")
  values <- c(
    0, 0, 0.79, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.29, 0, 2.62, 0, 0, 0, 0, 0, 0, 0, 0.37, 0, 0, 0,
    0, 0, 0.47, 0, 0, 0, 0, 0, 0, 0, 0, 0.08, 0, 0, 1.11, 1.15, 0.85, 0, 0, 0, 0, 0, 0, 0, 0, 1.53, 6.61, 2.1, 0.32, 1.52, 0.8,
    1.29, 4.5, 8.14, 9.51, 0, 0, 0.85, 0.21, 1.22, 3.12, 0, 0, 0, 0, 0.88, 0, 0, 0, 0.1, 0, 0.71, 3.43, 3.89, 2.03, 0.8, 2.75, 0.16, 0, 0, 0,
    1.2, 0, 4.37, 1.64, 1.6, 0, 0, 0.95, 0, 0, 2.79, 4.42, 2.89, 0.68, 2.98, 7.25, 3.27, 0.56, 1.82, 0.72, 0.64, 4.66, 0.83, 0.58, 3.07, 7.79, 4.42, 0.04, 1.28, 5.58, 4.59,
    1.28, 1.9, 0.2, 0.99, 2.42, 5.77, 5.07, 6.18, 13.06, 4.96, 4.66, 3.28, 4.58, 12.17, 5.37, 9.15, 9.3, 6.08, 12.89, 2.5, 2.63, 4.51, 3.69, 4.27, 5.66, 10.04, 8.42, 10.67, 14.34, 21.07,
    12.03, 3.36, 2.53, 2.78, 2.93, 3.53, 5.07, 2.69, 4.58, 2.37, 2.84, 3.81, 5.28, 6.37, 11.07, 10.1, 12.28, 7.75, 5.31, 6.69, 10.91, 15.13, 14.89, 2.82, 4.52, 7.79, 6.01, 8.85, 10.42, 11.5, 14.17,
    9.39, 14.08, 6.04, 4.9, 5.59, 5.9, 9.05, 12.5, 14.19, 16.58, 15.26, 14.26, 6.42, 3.14, 2.99, 1.82, 2.1, 4.62, 5.87, 9.41, 14.86, 9.7, 5.86, 7.34, 11.94, 14.2, 11.74, 8.58, 6.1, 8.21, 11.86,
    8.97, 6.73, 5.25, 3.99, 5.36, 9.5, 12.29, 9.37, 10.35, 8.51, 10.68, 18.23, 7.58, 5.51, 5.13, 3.92, 6.87, 5.65, 7.19, 12.22, 10.1, 7.28, 8.32, 6.74, 8.79, 13.91, 14.65, 20.55,
    10.17, 7.34, 9.38, 10.65, 10.65, 4.62, 4.02, 7.78, 7.72, 4.67, 4.65, 5.76, 10.02, 9.69, 7.61, 7.39, 8.32, 7.92, 9.41, 13.52, 14.63, 12.74, 6.83, 7.19, 6.92, 3.76, 2.63, 2.62, 2.89, 3.32, 0.78,
    3.73, 3.44, 3.29, 2.2, 2.74, 5.03, 6.82, 4.01, 2.65, 1.47, 1.68, 4.22, 1.53, 0, 0, 1.47, 3.58, 5.24, 7.86, 2.05, 1.66, 5.56, 10.26, 9.03, 5.14, 3.78, 4.85, 4.61, 3.9, 2.41,
    1.17, 0, 0, 0, 0, 0, 1.35, 3.69, 3.58, 3.54, 4.21, 5.19, 5.16, 5.03, 3.33, 2.41, 0.69, 0, 0.69, 0.25, 0, 0.69, 0, 0, 0.7, 1.66, 2.44, 0, 0, 1.5, 2.6,
    2.42, 2.57, 0.61, 0.56, 1.08, 0, 0.57, 0, 0, 2.43, 1.27, 2.78, 1.4, 1.36, 0.99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)


  test_that("calc_accumulated_heat calculates Accumulated Heat (GDD) correctly when all data used", {
    result <- calc_accumulated_heat(dates = dates, GDD_values = values, from_Austral_month = 1, to_Austral_month = 12)
    expected <- c(0, 0, 0.79, 0.79, 0.79, 0.79, 0.79, 0.79, 0.79, 0.79, 0.79, 0.79, 0.79, 0.79, 0.79, 0.79, 0.79, 1.08, 1.08, 3.7, 3.7, 3.7, 3.7, 3.7, 3.7, 3.7, 3.7, 4.07, 4.07, 4.07, 4.07, 4.07, 4.07, 4.54, 4.54, 4.54, 4.54, 4.54, 4.54, 4.54, 4.54, 4.54, 4.62, 4.62, 4.62, 5.73, 6.88, 7.73, 7.73, 7.73, 7.73, 7.73, 7.73, 7.73, 7.73, 7.73, 9.26, 15.87, 17.97, 18.29, 19.81, 20.61, 21.9, 26.4, 34.54, 44.05, 44.05, 44.05, 44.9, 45.11, 46.33, 49.45, 49.45, 49.45, 49.45, 49.45, 50.33, 50.33, 50.33, 50.33, 50.43, 50.43, 51.14, 54.57, 58.46, 60.49, 61.29, 64.04, 64.2, 64.2, 64.2, 64.2, 65.4, 65.4, 69.77, 71.41, 73.01, 73.01, 73.01, 73.96, 73.96, 73.96, 76.75, 81.17, 84.06, 84.74, 87.72, 94.97, 98.24, 98.8, 100.62, 101.34, 101.98, 106.64, 107.47, 108.05, 111.12, 118.91, 123.33, 123.37, 124.65, 130.23, 134.82, 136.1, 138, 138.2, 139.19, 141.61, 147.38, 152.45, 158.63, 171.69, 176.65, 181.31, 184.59, 189.17, 201.34, 206.71, 215.86, 225.16, 231.24, 244.13, 246.63, 249.26, 253.77, 257.46, 261.73, 267.39, 277.43, 285.85, 296.52, 310.86, 331.93, 343.96, 347.32, 349.85, 352.63, 355.56, 359.09, 364.16, 366.85, 371.43, 373.8, 376.64, 380.45, 385.73, 392.1, 403.17, 413.27, 425.55, 433.3, 438.61, 445.3, 456.21, 471.34, 486.23, 489.05, 493.57, 501.36, 507.37, 516.22, 526.64, 538.14, 552.31, 561.7, 575.78, 581.82, 586.72, 592.31, 598.21, 607.26, 619.76, 633.95, 650.53, 665.79, 680.05, 686.47, 689.61, 692.6, 694.42, 696.52, 701.14, 707.01, 716.42, 731.28, 740.98, 746.84, 754.18, 766.12, 780.32, 792.06, 800.64, 806.74, 814.95, 826.81, 835.78, 842.51, 847.76, 851.75, 857.11, 866.61, 878.9, 888.27, 898.62, 907.13, 917.81, 936.04, 943.62, 949.13, 954.26, 958.18, 965.05, 970.7, 977.89, 990.11, 1000.21, 1007.49, 1015.81, 1022.55, 1031.34, 1045.25, 1059.9, 1080.45, 1090.62, 1097.96, 1107.34, 1117.99, 1128.64, 1133.26, 1137.28, 1145.06, 1152.78, 1157.45, 1162.1, 1167.86, 1177.88, 1187.57, 1195.18, 1202.57, 1210.89, 1218.81, 1228.22, 1241.74, 1256.37, 1269.11, 1275.94, 1283.13, 1290.05, 1293.81, 1296.44, 1299.06, 1301.95, 1305.27, 1306.05, 1309.78, 1313.22, 1316.51, 1318.71, 1321.45, 1326.48, 1333.3, 1337.31, 1339.96, 1341.43, 1343.11, 1347.33, 1348.86, 1348.86, 1348.86, 1350.33, 1353.91, 1359.15, 1367.01, 1369.06, 1370.72, 1376.28, 1386.54, 1395.57, 1400.71, 1404.49, 1409.34, 1413.95, 1417.85, 1420.26, 1421.43, 1421.43, 1421.43, 1421.43, 1421.43, 1421.43, 1422.78, 1426.47, 1430.05, 1433.59, 1437.8, 1442.99, 1448.15, 1453.18, 1456.51, 1458.92, 1459.61, 1459.61, 1460.3, 1460.55, 1460.55, 1461.24, 1461.24, 1461.24, 1461.94, 1463.6, 1466.04, 1466.04, 1466.04, 1467.54, 1470.14, 1472.56, 1475.13, 1475.74, 1476.3, 1477.38, 1477.38, 1477.95, 1477.95, 1477.95, 1480.38, 1481.65, 1484.43, 1485.83, 1487.19, 1488.18, 1488.18, 1488.18, 1488.18, 1488.18, 1488.18, 1488.18, 1488.18, 1488.18, 1488.18, 1488.18, 1488.18, 1488.18, 1488.18, 1488.18, 1488.18)
    expect_equal(result, expected)
  })

  test_that("calc_accumulated_heat calculates Accumulated Heat (GDD) correctly for changing months", {
    result <- calc_accumulated_heat(dates = dates, GDD_values = values, from_Austral_month = 2, to_Austral_month = 11)
    expected <- c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0.47, 0.47, 0.47, 0.47, 0.47, 0.47, 0.47, 0.47, 0.47, 0.55, 0.55, 0.55, 1.66, 2.81, 3.66, 3.66, 3.66, 3.66, 3.66, 3.66, 3.66, 3.66, 3.66, 5.19, 11.8, 13.9, 14.22, 15.74, 16.54, 17.83, 22.33, 30.47, 39.98, 39.98, 39.98, 40.83, 41.04, 42.26, 45.38, 45.38, 45.38, 45.38, 45.38, 46.26, 46.26, 46.26, 46.26, 46.36, 46.36, 47.07, 50.5, 54.39, 56.42, 57.22, 59.97, 60.13, 60.13, 60.13, 60.13, 61.33, 61.33, 65.7, 67.34, 68.94, 68.94, 68.94, 69.89, 69.89, 69.89, 72.68, 77.1, 79.99, 80.67, 83.65, 90.9, 94.17, 94.73, 96.55, 97.27, 97.91, 102.57, 103.4, 103.98, 107.05, 114.84, 119.26, 119.3, 120.58, 126.16, 130.75, 132.03, 133.93, 134.13, 135.12, 137.54, 143.31, 148.38, 154.56, 167.62, 172.58, 177.24, 180.52, 185.1, 197.27, 202.64, 211.79, 221.09, 227.17, 240.06, 242.56, 245.19, 249.7, 253.39, 257.66, 263.32, 273.36, 281.78, 292.45, 306.79, 327.86, 339.89, 343.25, 345.78, 348.56, 351.49, 355.02, 360.09, 362.78, 367.36, 369.73, 372.57, 376.38, 381.66, 388.03, 399.1, 409.2, 421.48, 429.23, 434.54, 441.23, 452.14, 467.27, 482.16, 484.98, 489.5, 497.29, 503.3, 512.15, 522.57, 534.07, 548.24, 557.63, 571.71, 577.75, 582.65, 588.24, 594.14, 603.19, 615.69, 629.88, 646.46, 661.72, 675.98, 682.4, 685.54, 688.53, 690.35, 692.45, 697.07, 702.94, 712.35, 727.21, 736.91, 742.77, 750.11, 762.05, 776.25, 787.99, 796.57, 802.67, 810.88, 822.74, 831.71, 838.44, 843.69, 847.68, 853.04, 862.54, 874.83, 884.2, 894.55, 903.06, 913.74, 931.97, 939.55, 945.06, 950.19, 954.11, 960.98, 966.63, 973.82, 986.04, 996.14, 1003.42, 1011.74, 1018.48, 1027.27, 1041.18, 1055.83, 1076.38, 1086.55, 1093.89, 1103.27, 1113.92, 1124.57, 1129.19, 1133.21, 1140.99, 1148.71, 1153.38, 1158.03, 1163.79, 1173.81, 1183.5, 1191.11, 1198.5, 1206.82, 1214.74, 1224.15, 1237.67, 1252.3, 1265.04, 1271.87, 1279.06, 1285.98, 1289.74, 1292.37, 1294.99, 1297.88, 1301.2, 1301.98, 1305.71, 1309.15, 1312.44, 1314.64, 1317.38, 1322.41, 1329.23, 1333.24, 1335.89, 1337.36, 1339.04, 1343.26, 1344.79, 1344.79, 1344.79, 1346.26, 1349.84, 1355.08, 1362.94, 1364.99, 1366.65, 1372.21, 1382.47, 1391.5, 1396.64, 1400.42, 1405.27, 1409.88, 1413.78, 1416.19, 1417.36, 1417.36, 1417.36, 1417.36, 1417.36, 1417.36, 1418.71, 1422.4, 1425.98, 1429.52, 1433.73, 1438.92, 1444.08, 1449.11, 1452.44, 1454.85, 1455.54, 1455.54, 1456.23, 1456.48, 1456.48, 1457.17, 1457.17, 1457.17, 1457.87, 1459.53, 1461.97, 1461.97, 1461.97, 1463.47, 1466.07, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA)
    expect_equal(result, expected)
  })

  test_that("calc_accumulated_heat calculates Accumulated Heat (GDD) correctly for changing months", {
    result <- calc_accumulated_heat(dates = dates, GDD_values = values, from_Austral_month = 3, to_Austral_month = 10)
    expected <- c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 1.29, 5.79, 13.93, 23.44, 23.44, 23.44, 24.29, 24.5, 25.72, 28.84, 28.84, 28.84, 28.84, 28.84, 29.72, 29.72, 29.72, 29.72, 29.82, 29.82, 30.53, 33.96, 37.85, 39.88, 40.68, 43.43, 43.59, 43.59, 43.59, 43.59, 44.79, 44.79, 49.16, 50.8, 52.4, 52.4, 52.4, 53.35, 53.35, 53.35, 56.14, 60.56, 63.45, 64.13, 67.11, 74.36, 77.63, 78.19, 80.01, 80.73, 81.37, 86.03, 86.86, 87.44, 90.51, 98.3, 102.72, 102.76, 104.04, 109.62, 114.21, 115.49, 117.39, 117.59, 118.58, 121, 126.77, 131.84, 138.02, 151.08, 156.04, 160.7, 163.98, 168.56, 180.73, 186.1, 195.25, 204.55, 210.63, 223.52, 226.02, 228.65, 233.16, 236.85, 241.12, 246.78, 256.82, 265.24, 275.91, 290.25, 311.32, 323.35, 326.71, 329.24, 332.02, 334.95, 338.48, 343.55, 346.24, 350.82, 353.19, 356.03, 359.84, 365.12, 371.49, 382.56, 392.66, 404.94, 412.69, 418, 424.69, 435.6, 450.73, 465.62, 468.44, 472.96, 480.75, 486.76, 495.61, 506.03, 517.53, 531.7, 541.09, 555.17, 561.21, 566.11, 571.7, 577.6, 586.65, 599.15, 613.34, 629.92, 645.18, 659.44, 665.86, 669, 671.99, 673.81, 675.91, 680.53, 686.4, 695.81, 710.67, 720.37, 726.23, 733.57, 745.51, 759.71, 771.45, 780.03, 786.13, 794.34, 806.2, 815.17, 821.9, 827.15, 831.14, 836.5, 846, 858.29, 867.66, 878.01, 886.52, 897.2, 915.43, 923.01, 928.52, 933.65, 937.57, 944.44, 950.09, 957.28, 969.5, 979.6, 986.88, 995.2, 1001.94, 1010.73, 1024.64, 1039.29, 1059.84, 1070.01, 1077.35, 1086.73, 1097.38, 1108.03, 1112.65, 1116.67, 1124.45, 1132.17, 1136.84, 1141.49, 1147.25, 1157.27, 1166.96, 1174.57, 1181.96, 1190.28, 1198.2, 1207.61, 1221.13, 1235.76, 1248.5, 1255.33, 1262.52, 1269.44, 1273.2, 1275.83, 1278.45, 1281.34, 1284.66, 1285.44, 1289.17, 1292.61, 1295.9, 1298.1, 1300.84, 1305.87, 1312.69, 1316.7, 1319.35, 1320.82, 1322.5, 1326.72, 1328.25, 1328.25, 1328.25, 1329.72, 1333.3, 1338.54, 1346.4, 1348.45, 1350.11, 1355.67, 1365.93, 1374.96, 1380.1, 1383.88, 1388.73, 1393.34, 1397.24, 1399.65, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA)
    expect_equal(result, expected)
  })

  test_that("calc_accumulated_heat errors for incorrect parameters", {
    expect_error(calc_accumulated_heat(dates = dates, GDD_values = values, from_Austral_month = 13, to_Austral_month = 14))
  })
}


